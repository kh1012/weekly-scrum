# Cursor V2 작업 요청: 스냅샷 관리 메뉴 개발 + 문서 정비 + v2 검증 지침 작성

아래 내용은 통째로 복사해서 Cursor에 붙여서 실행할 작업 지시문이다.  
중요한 점: 디렉토리 구조와 파일 위치는 **지금 프로젝트에 이미 존재하는 구조를 최우선**으로 따르고,  
새로 제안된 구조는 참고용으로만 사용해라.

---

## 0. 작업 전 공통 규칙

1. 프로젝트 구조를 먼저 스캔해서, 스냅샷 관련 코드/문서/컴포넌트/훅/유틸이 어디에 있는지 파악하고 짧게 요약해라.
2. 새로운 코드나 파일을 만들 때는 **기존 패턴과 네이밍, 디렉토리 구조를 최대한 그대로 따를 것**.
3. 이 문서에서 제안하는 디렉토리(예: src/defines 등)는 “추천안”일 뿐이며,  
   실제 적용은 기존 구조에 자연스럽게 녹아들도록 조정해라.
4. 모든 변경 후에는 타입체크 및 빌드가 통과하는지 확인해라.

---

## 1. 스냅샷 관리 메뉴 페이지 구현

### 1-1. 개요

목표: 매주 스냅샷을 더 빠르고 편하게 작성할 수 있는 **관리 전용 화면**을 만든다.

특징:

- 기존 스냅샷을 이름/주차 기준으로 불러오기
- 새 스냅샷 카드 생성
- 여러 장의 스냅샷을 동시에 편집
- JSON / Plain Text 형식으로 클립보드 복사
- 이 화면의 모든 데이터는 **임시 데이터**이며, 어디에도 직접 저장하지 않는다.

새 페이지/컴포넌트/훅을 만들 때,

- 먼저 기존 스냅샷 관련 라우트/컴포넌트 위치를 확인하고,
- 그 구조에 맞춰 파일을 생성해라. (예: app/snapshots/manage/page.tsx 등)

---

### 1-2. 초기 진입 화면

초기 진입 시 화면에는 두 개의 진입점이 있어야 한다.

- [데이터 불러오기]
- [새로 작성하기]

단순한 카드 두 개, 혹은 버튼 두 개로 구성해도 된다.  
향후 “최근 작업 이어서 하기” 같은 기능을 붙일 수 있도록, 적당히 여유 있는 레이아웃으로 설계해라.

---

### 1-3. “데이터 불러오기” 기능

사용자는 두 가지 방식으로 기존 스냅샷을 불러올 수 있다.

#### A. 이름 기준 선택

- 왼쪽: 이름 체크박스 리스트
  - 전체 선택 / 개별 선택 지원
- 오른쪽: 선택된 이름들에서 실제로 스냅샷이 존재하는 주차 리스트
  - 예: [ ] 2025-12-W01 (2025-12-01 ~ 2025-12-05)
  - 전체 선택 / 개별 선택 지원
- 선택된 (이름 × 주차) 조합만큼 관리 페이지의 편집 리스트에 스냅샷 카드가 추가된다.

#### B. 주차 기준 선택

- 왼쪽: 주차 체크박스 리스트
  - 예: [ ] 2025-12-W01 (2025-12-01 ~ 2025-12-05)
  - 전체 선택 / 개별 선택 지원
- 오른쪽: 해당 주차에 실제로 스냅샷이 존재하는 이름 리스트
  - 전체 선택 / 개별 선택 지원
- 선택된 (주차 × 이름) 조합만큼 스냅샷 카드가 추가된다.

#### 공통 요구사항

- 이미 추가된 (이름, 주차) 조합은 **중복으로 추가되지 않도록** 방어 로직을 넣어라.
- 이름/주차 메타 정보를 읽어오는 로직은 훅이나 유틸 함수로 분리해서 공통으로 사용해라.
- 불러온 데이터는 모두 **v2 스키마 형태**로 맞춰서 관리 페이지 상태에 적재되도록 변환 헬퍼를 작성해라.
  - v1 형식이 섞여 있다면 v2로 매핑하는 곳을 한 군데로 모아 두는 것을 목표로 한다.

---

### 1-4. “새로 작성하기” 기능

- [새로 작성하기] 버튼을 누르면 바로 편집 화면으로 이동한다.
- 이 때 기본적으로 **빈 스냅샷 카드 1개**를 생성해서 편집 리스트에 넣어둔다.
- 추가 카드는 편집 화면 내의 “+ 빈 카드 추가” 버튼으로 생성한다.

---

### 1-5. 편집 화면 레이아웃

편집 화면은 다음과 같은 2단 구조로 만든다.

- 좌측: 스냅샷 카드 리스트 (각 카드가 접힌 상태로 요약)
- 우측: 선택된 카드의 상세 편집 폼

#### 좌측: 카드 리스트

기능 요구사항:

- 각 카드는 다음 정도의 요약 정보를 가진다.
  - 대략 domain / project / module / feature / name / week 조합 중 적절한 것
- 카드 단위 기능:
  - 카드 선택 (우측 편집 영역 활성화)
  - 접기 / 펼치기
  - 카드 삭제
  - 카드 단위 JSON 복사
  - 카드 단위 Plain Text 복사
  - 카드 단위 Styled 보기 ↔ Plain Text 보기 토글
- 리스트 상단 혹은 하단:
  - “+ 빈 카드 추가” 버튼
- 전체 공통 기능(리스트 상단 등):
  - 전체 카드 보기 모드 토글: Styled 카드 UI ↔ Plain Text 일괄 전환
  - 전체 카드 JSON 클립보드 복사
  - 전체 카드 Plain Text 클립보드 복사 (각 카드는 빈 줄 하나로 구분해서 붙여넣기 좋게)

이 화면에서 다루는 데이터는 전부 **임시 상태**이므로, 주석에 반드시 “임시 작업 공간용 상태”라는 설명을 남겨라. 나중에 실제 저장 기능이 필요할 때 연결할 수 있도록 상태/구조를 설계해라.

#### 우측: 카드 상세 편집 폼

아래 2장에서 설명하는 v2 스키마 기준 편집 필드 구성을 따른다.

---

## 2. 카드 상세 편집 폼 구성 (v2 스키마 기준)

여기서 중요한 포인트는 다음이다.

- 메타 필드(domain, project, module, feature)는 **고정 옵션이 있는 콤보박스**이지만,
- 이 고정 옵션들을 코드에서 쉽게 관리할 수 있도록 **별도 배열로 분리**한다.
- define.ts 같은 파일 이름과 위치는 기존 프로젝트 스타일에 맞춰 결정하고,
  마지막에 “실제로 어떤 경로에 무엇을 만들었는지”를 요약해라.

### 2-1. 메타 영역

대상 필드:

- domain
- project
- module
- feature

요구사항:

- 기본 입력 방식은 고정 옵션이 들어간 **콤보박스**.
- 콤보박스 항목의 실제 값 목록은 코드 상의 배열로 관리한다.
- 예시로 아래와 같은 배열이 필요하다. (실제 값은 프로젝트 상황에 맞게 조정)

  - DOMAIN_OPTIONS
  - PROJECT_OPTIONS
  - MODULE_OPTIONS
  - FEATURE_OPTIONS

- 배열 정의 위치는 예를 들어 다음과 같을 수 있다.
  - src/defines/snapshotMeta.ts
  - 또는 기존에 options/constants/defines를 관리하는 파일이 이미 있다면 그 구조에 맞춰 넣어라.
- 각 콤보박스의 마지막에는 “사용자 정의” 항목을 둔다.
  - 사용자가 “사용자 정의”를 선택하면 해당 필드는 즉시 **텍스트 입력 필드**로 전환되어 자유롭게 입력 가능해야 한다.

중요: 실제 구현 시에는 반드시 기존 코드베이스 내에 “상수/옵션/정의”를 모아둔 위치가 있는지 먼저 확인하고,  
그 위치를 재사용하거나 확장하는 방식으로 작업해라. 이 문서에 적힌 경로는 예시일 뿐이다.

### 2-2. 일반 텍스트 필드

단일 문자열로 다루는 필드들이다.

- name
  - 전체 구성원 이름 리스트에서 선택하는 콤보박스 + “사용자 정의” 전환 지원
  - 이름 리스트 역시 배열로 분리해서 코드 상에서 관리한다.
  - 예시 배열 이름:
    - NAME_OPTIONS
    - 실제 위치는 기존 구조 보고 맞춰라. (예: src/defines/names.ts 등)
- 그 외 v2 스키마상 단일 문자열 필드
  - 예시: pastWeek.title, thisWeek.title 등
  - 실제 필드명은 이미 정의된 v2 스키마 문서를 기준으로 맞춘다.

### 2-3. 멀티라인 텍스트 필드

기본 높이가 넉넉한 textarea로 구성한다.

- pastWeek.tasks
- pastWeek.risks (또는 v2 스키마에 정의된 위험 관련 필드 이름)
- thisWeek.tasks

요구사항:

- 줄바꿈 여러 개를 허용한다.
- 내부 상태는 상황에 따라 문자열 또는 배열로 관리해도 되지만,
  최종적으로는 **v2 스키마에서 정의한 형태**로 변환해서 저장/복사해야 한다.
- Plain Text ↔ JSON 변환 로직은 별도 유틸 함수로 분리해두면 좋다.

### 2-4. collaborators

v2 스키마 구조를 그대로 사용한다.  
예상 구조(실제 스키마 정의 파일을 확인해서 맞춰라):

- collaborators: 배열
  - 각 항목: { name: string, relations: string[] }

#### collaborator.name

- NAME_OPTIONS 기반 콤보박스
- “사용자 정의” 선택 시 텍스트 입력 필드로 전환
- NAME_OPTIONS 배열은 별도 정의 파일(예: src/defines/names.ts)에서 관리하되,  
  실제 위치는 기존 프로젝트 패턴에 맞춰 정리한다.

#### collaborator.relations

- 가능한 값: "pair", "pre", "post"
- 이 값들을 배열로 관리한다. 예시 이름: RELATION_OPTIONS
- UI는 RELATION_OPTIONS를 기준으로 한 **복수 선택 체크박스**
- 내부 저장 형식은 relations: string[]  
  (실제 타입은 ("pair" | "pre" | "post")[] 형태로 제한하는 것이 이상적이다.)

---

## 3. v2 스키마 문서 정비

이미 존재하는 snapshot-guide-v2.md 파일을 최신 상태로 업데이트한다.

### 3-1. snapshot-guide-v2.md 업데이트

해야 할 일:

1. 현재 코드 상의 v2 스키마 타입/구조를 확인하고,  
   문서에 적힌 내용과 실제 구현이 일치하는지 비교해라.
2. 다음 변경 사항이 문서에 명확히 반영되었는지 확인하고, 없다면 보완해라.
   - risk → risks (키 이름 변경)
   - collaborator 관계: 단일 relation → relations 배열
3. Plan / Progress / Next / Risks / Collaborators 등 각 필드에 대해
   - 필수 여부
   - 타입
   - 작성 규칙
   - 예시
     를 꼼꼼히 정리해라.
4. JSON 예시와 Plain Text 예시를 v2 기준으로 갱신해라.
5. “메타 옵션(domain/project/module/feature가 콤보박스 + 사용자 정의 입력으로 동작한다”는 점도 문서에 반영해라.

문서의 목표는:

- 팀원이 이 문서만 보고도 스냅샷을 제대로 작성할 수 있고,
- 타입 정의와 1:1로 상응하는 **단일 진실의 근원(SSOT)** 이 되는 것이다.

---

## 3-2. snapshot-validation-v2.md 신규 작성

새로운 검증 지침 문서를 만든다.  
목표: AI 또는 스크립트가 스냅샷 데이터를 검증할 때 참고하는 룰북.

권장 구조:

1. Purpose
   - 이 문서가 무엇을 위한 것인지 명확하게 적는다.
2. Input Format
   - 스냅샷 검증 시 어떤 형식의 데이터를 입력으로 받는지 설명한다.
   - 예: JSON 배열, 각 원소가 하나의 스냅샷, 혹은 특정 Plain Text 포맷 등.
3. Schema Rules
   - v2 스키마 구조 정의
   - 필수/선택 필드
   - 각 필드의 타입 및 허용 값
   - domain/project/module/feature/collaborators 구조 등
4. Content Rules
   - Plan/Progress/Next에는 반드시 퍼센트(%)가 들어가야 하는지 등의 규칙
   - Risks를 어떻게 작성해야 하는지 (비워도 되는지, 최소 내용 등)
   - Collaborators.name과 relations에 대한 제약사항
5. Backward Compatibility Rules
   - 과거 v1 형식이 들어왔을 때 어떻게 처리할지 정의한다.
   - 예: risk만 있고 risks가 없을 때 변환 규칙, relation만 있고 relations 없을 때 처리 등.
6. Validation Output Format
   - 검증 결과를 어떤 형식으로 반환해야 하는지 정의.
   - 예: 각 스냅샷마다 status (ok / warning / error)와 messages 배열 등.
7. Examples
   - 올바른 예제와 잘못된 예제를 함께 제공하고,  
     각각 어떤 검증 결과가 나와야 하는지 예측값을 적는다.
8. AI Prompt Template
   - “아래 JSON 배열이 snapshot-validation-v2.md에 정의된 규칙을 모두 만족하는지 검사하라”와 같은 템플릿을 구체적으로 적어둔다.
   - AI가 어떻게 응답해야 하는지까지 포함한다.

---

## 4. 디렉토리 / 파일 구조에 대한 지침

이 문서에서 예시로 제안한 구조는 다음과 같다.

- 스냅샷 메타 옵션 정의
  - 예: src/defines/snapshotMeta.ts
- 이름 리스트 정의
  - 예: src/defines/names.ts
- v2 스키마 가이드 문서
  - 예: docs/snapshot-guide-v2.md
- v2 검증 지침 문서
  - 예: docs/snapshot-validation-v2.md
- 스냅샷 관리 페이지
  - 예: app/snapshots/manage/page.tsx (또는 프로젝트 구조에 적합한 위치)

하지만 실제 구현 시에는 반드시 다음 순서를 따르라.

1. 먼저 기존 프로젝트의 디렉토리 구조와 네이밍 패턴을 확인한다.
2. 이미 options/constants/defines/configs 등의 파일이 존재한다면,  
   그 위치와 스타일을 **최대한 재사용**한다.
3. 새로운 디렉토리나 파일을 만들었다면,
   - 왜 그렇게 배치했는지,
   - 어떤 역할을 하는지,
     를 코드 상단 주석이나 커밋 메시지, 혹은 요약 코멘트로 남겨라.
4. 최종적으로 실제로 구성된 구조(경로, 파일명)를 간략히 정리해서 남겨라.

---

## 5. 마무리 체크리스트

마지막으로 아래 항목을 모두 충족했는지 확인해라.

- 스냅샷 관리 페이지에서
  - 데이터 불러오기(이름 기준 / 주차 기준)가 동작하는지
  - 새로 작성하기가 동작하는지
  - 카드 생성 / 삭제 / 선택 / 편집이 정상 동작하는지
  - 개별 카드 및 전체 카드에 대해 JSON/Plain Text 복사가 잘 되는지
- 메타 필드(domain/project/module/feature/relations/name)의 옵션이  
  코드 상의 배열로 분리되어 있고, 사용자 정의 입력 전환이 잘 동작하는지
- snapshot-guide-v2.md 가 실제 v2 스키마와 일치하는지
- snapshot-validation-v2.md 가 작성되어 있고,  
  실제 예제 JSON을 넣었을 때 어떤 식으로 검증해야 하는지 명확히 정의되어 있는지
- 타입체크와 빌드가 모두 통과하는지

---

여기까지가 전체 작업 지시문이다.  
이제 위 내용을 순차적으로 수행하면서, 단계별 변경 사항과 구조를 정리해줘.
